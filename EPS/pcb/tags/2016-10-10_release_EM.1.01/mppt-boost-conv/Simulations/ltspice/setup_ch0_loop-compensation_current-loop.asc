Version 4
SHEET 1 3288 1092
WIRE 1136 -256 720 -256
WIRE 1168 -256 1136 -256
WIRE 1200 -256 1168 -256
WIRE 1504 -256 1200 -256
WIRE 1728 -256 1664 -256
WIRE 1872 -256 1728 -256
WIRE 720 -240 720 -256
WIRE 1200 -240 1200 -256
WIRE 400 -224 288 -224
WIRE 448 -224 400 -224
WIRE 560 -208 544 -208
WIRE 1504 -208 1472 -208
WIRE 448 -192 416 -192
WIRE 416 -176 416 -192
WIRE 1904 -176 1872 -176
WIRE 1200 -160 1200 -176
WIRE 1472 -160 1472 -208
WIRE 1728 -160 1728 -176
WIRE 1904 -160 1904 -176
WIRE 1872 -144 1872 -176
WIRE 2000 -128 1920 -128
WIRE 1136 -96 1136 -256
WIRE 1920 -64 1920 -80
WIRE 1920 -64 1872 -64
WIRE 1872 -48 1872 -64
WIRE 1600 16 1536 16
WIRE 2640 16 1680 16
WIRE 336 32 336 16
WIRE 640 48 640 32
WIRE 1136 96 1136 -16
WIRE 2320 128 2208 128
WIRE 880 192 832 192
WIRE 896 192 880 192
WIRE 992 192 896 192
WIRE 1136 192 1136 176
WIRE 1136 192 992 192
WIRE 880 208 880 192
WIRE 720 224 528 224
WIRE 784 224 784 208
WIRE 784 224 720 224
WIRE 832 224 832 192
WIRE 832 224 784 224
WIRE 2256 224 2208 224
WIRE 2464 224 2464 128
WIRE 2464 224 2320 224
WIRE 288 240 288 -224
WIRE 384 240 288 240
WIRE 432 240 384 240
WIRE 384 256 384 240
WIRE 720 256 528 256
WIRE 784 256 720 256
WIRE 832 256 784 256
WIRE 1856 256 1792 256
WIRE 1984 256 1920 256
WIRE 784 272 784 256
WIRE 992 272 992 192
WIRE 1536 272 1536 16
WIRE 1536 272 992 272
WIRE 832 288 832 256
WIRE 880 288 832 288
WIRE 288 304 288 240
WIRE 1072 336 992 336
WIRE 1104 336 1072 336
WIRE 1200 336 1184 336
WIRE 1248 336 1200 336
WIRE 1456 336 1408 336
WIRE 384 352 384 336
WIRE 1648 368 1520 368
WIRE 1792 368 1792 256
WIRE 1792 368 1728 368
WIRE 1840 368 1792 368
WIRE 1984 368 1984 256
WIRE 1984 368 1920 368
WIRE 2096 368 2080 368
WIRE 2208 368 2208 224
WIRE 2208 368 2176 368
WIRE 2240 368 2208 368
WIRE 1248 384 1232 384
WIRE 2464 400 2464 224
WIRE 2464 400 2384 400
WIRE 2640 400 2640 16
WIRE 2640 400 2464 400
WIRE 288 416 288 368
WIRE 384 416 288 416
WIRE 1232 416 1232 384
WIRE 384 432 384 416
WIRE 1520 432 1520 368
WIRE 1984 432 1984 368
WIRE 2240 432 1984 432
WIRE 992 448 992 336
WIRE 2080 496 2080 368
WIRE 1792 528 1792 368
WIRE 1824 528 1792 528
WIRE 1984 560 1984 432
WIRE 1984 560 1968 560
WIRE 1072 576 1072 336
WIRE 1232 576 1072 576
WIRE 1552 592 1376 592
WIRE 1664 592 1632 592
WIRE 1744 592 1664 592
WIRE 1824 592 1744 592
WIRE 1200 624 1200 336
WIRE 1232 624 1200 624
WIRE 1744 640 1744 592
WIRE 1664 656 1664 592
WIRE 1664 736 1664 720
WIRE 1744 736 1744 720
WIRE 1744 736 1664 736
WIRE 1744 752 1744 736
FLAG 400 -224 Vc
FLAG 1200 -160 0
FLAG 720 224 Vgma_i
FLAG 1168 -256 Vout
FLAG 784 352 0
FLAG 384 432 0
FLAG 784 128 0
FLAG 896 192 FB
FLAG 720 256 Vgma_ni
FLAG 992 528 0
FLAG 416 -176 0
FLAG 560 -208 Ivin
FLAG 1472 -160 0
FLAG 720 -160 0
FLAG 640 48 0
FLAG 336 32 0
FLAG 336 -48 Vin
FLAG 640 -48 Vin
FLAG 2272 480 0
FLAG 2320 480 0
FLAG 2272 320 Vin
FLAG 1904 640 0
FLAG 1856 640 0
FLAG 1856 480 Vin
FLAG 1456 336 Vin
FLAG 992 336 V3
FLAG 1232 416 0
FLAG 2512 -48 0
FLAG 2512 -128 Vbatmin
FLAG 1728 -160 Vbatmin
FLAG 1872 -48 Vbatmin
FLAG 2000 -48 Vbatmin
FLAG 1520 512 0
FLAG 1744 752 0
FLAG 2080 576 0
SYMBOL bi 720 -160 R180
WINDOW 0 -71 52 Left 2
WINDOW 3 -337 116 Left 2
SYMATTR InstName B2
SYMATTR Value I=limit(0, ((n*V(Vin))/V(Vout))*V(Ivin), 2)
SYMBOL cap 1184 -240 R0
WINDOW 0 37 11 Left 2
WINDOW 3 37 61 Left 2
WINDOW 39 39 37 Left 2
SYMATTR InstName C1
SYMATTR Value 20µF
SYMATTR SpiceLine Rser=10m Lser=3n
SYMATTR SpiceLine2 IC=7.8
SYMBOL voltage 784 256 R0
WINDOW 0 37 58 Left 2
WINDOW 3 36 81 Left 2
WINDOW 123 36 109 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V2
SYMATTR Value 1.215V
SYMBOL res 864 192 R0
WINDOW 3 35 69 Left 2
SYMATTR Value 14.6k
SYMATTR InstName R5
SYMBOL res 768 112 R0
WINDOW 0 36 36 Left 2
WINDOW 3 35 58 Left 2
SYMATTR InstName R6
SYMATTR Value 14.6k
SYMBOL res 1120 80 R0
WINDOW 3 36 67 Left 2
SYMATTR Value {Ra}
SYMATTR InstName R1
SYMBOL res 368 240 R0
SYMATTR InstName R8
SYMATTR Value {Rc}
SYMBOL cap 368 352 R0
SYMATTR InstName C2
SYMATTR Value {Cc}
SYMBOL voltage 992 432 R0
WINDOW 0 34 37 Left 2
WINDOW 3 34 66 Left 2
WINDOW 123 34 116 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V3
SYMATTR Value 3.5V
SYMBOL cap 272 304 R0
SYMATTR InstName C3
SYMATTR Value {Cf}
SYMBOL res 1856 -272 R0
WINDOW 3 37 63 Left 2
SYMATTR Value 40R
SYMATTR InstName R4
SYMBOL sw 1872 -48 R180
WINDOW 0 43 36 Left 2
WINDOW 3 44 66 Left 2
SYMATTR InstName S1
SYMBOL voltage 2000 -144 R0
WINDOW 0 -12 -2 Left 2
WINDOW 3 47 33 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V1
SYMATTR Value PULSE(0 5 20m 1n 1n 20m 40m 3)
SYMBOL ota 496 176 M0
WINDOW 0 -36 -12 Left 2
WINDOW 39 -150 13 Left 2
SYMATTR InstName X1
SYMATTR SpiceLine Ilimit=12u Gm=230u Ro=305k
SYMBOL ota 480 -144 M180
WINDOW 0 -48 153 Left 2
WINDOW 39 -148 129 Left 2
SYMATTR InstName X2
SYMATTR SpiceLine Ilimit=2 Gm=7 Ro=1R
SYMBOL voltage 1136 -112 R0
WINDOW 0 40 27 Left 2
WINDOW 3 40 77 Left 2
WINDOW 123 40 53 Left 2
WINDOW 39 40 55 Left 2
SYMATTR InstName V4
SYMATTR Value 0V
SYMATTR SpiceLine Rser=10m
SYMBOL res 1712 -272 R0
WINDOW 0 36 42 Left 2
WINDOW 3 36 65 Left 2
SYMATTR InstName R2
SYMATTR Value 40R
SYMBOL boost-converter_output-filter 1568 -256 R0
SYMATTR InstName X3
SYMBOL res 1200 320 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R3
SYMATTR Value 0.068
SYMBOL max4372 1296 608 R0
SYMATTR InstName X4
SYMBOL bi 640 -48 R0
WINDOW 0 39 21 Left 2
WINDOW 3 40 55 Left 2
SYMATTR InstName B1
SYMATTR Value I=limit(0,(V(Vout)/V(V3)*I(B2)*1/n),2)
SYMBOL cap 320 -48 R0
WINDOW 0 37 11 Left 2
WINDOW 3 37 61 Left 2
WINDOW 39 39 37 Left 2
SYMATTR InstName C6
SYMATTR Value 20µF
SYMATTR SpiceLine Rser=10m Lser=3n
SYMBOL Opamps\\LT1782 2272 400 R0
SYMATTR InstName U1
SYMBOL res 2080 384 R270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R7
SYMATTR Value 220k
SYMBOL cap 2256 240 R270
WINDOW 0 32 32 VTop 2
WINDOW 3 0 32 VBottom 2
SYMATTR InstName C5
SYMATTR Value 1n
SYMBOL Opamps\\LT1782 1856 560 R0
SYMATTR InstName U2
SYMBOL res 1696 0 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R9
SYMATTR Value 82k
SYMBOL cap 2464 112 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C7
SYMATTR Value 1n
SYMBOL res 2416 112 R90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R12
SYMATTR Value 22k
SYMBOL boost-converter_input-filter 1312 336 R0
SYMATTR InstName X5
SYMBOL voltage 2512 -144 R0
WINDOW 0 37 36 Left 2
WINDOW 3 40 63 Left 2
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V6
SYMATTR Value 5V
SYMBOL res 1824 352 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R10
SYMATTR Value 220k
SYMBOL res 1536 576 M90
WINDOW 0 0 56 VBottom 2
WINDOW 3 32 56 VTop 2
SYMATTR InstName R11
SYMATTR Value 10k
SYMBOL res 1728 736 M180
WINDOW 0 36 76 Left 2
WINDOW 3 36 40 Left 2
SYMATTR InstName R13
SYMATTR Value 220k
SYMBOL res 1744 384 M270
WINDOW 0 32 56 VTop 2
WINDOW 3 0 56 VBottom 2
SYMATTR InstName R14
SYMATTR Value 10k
SYMBOL voltage 1520 416 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
WINDOW 0 39 44 Left 2
WINDOW 3 41 73 Left 2
SYMATTR InstName V7
SYMATTR Value 0.5V
SYMBOL cap 1648 656 R0
SYMATTR InstName C4
SYMATTR Value 100n
SYMBOL cap 1920 240 R90
WINDOW 0 0 32 VBottom 2
WINDOW 3 32 32 VTop 2
SYMATTR InstName C8
SYMATTR Value 100n
SYMBOL voltage 2080 480 R0
WINDOW 123 0 0 Left 2
WINDOW 39 0 0 Left 2
SYMATTR InstName V5
SYMATTR Value 1.25V
TEXT 1304 176 Left 2 !.tran 200m
TEXT 1304 144 Left 2 !.param n 0.88
TEXT 1304 -8 Left 2 !.param Cf 47p\n.param Rc 27k\n.param Cc 1n\n.param Cpl 0p\n.param Ra=68.02k
TEXT 2048 -80 Left 2 !.model SW SW(Ron=0.001, Vt=1, Vh=1)
TEXT 1304 216 Left 2 !;ac oct 100 1 1Meg
